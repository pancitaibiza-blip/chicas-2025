<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FORTNITE SKIN BATTLE: ¬°DERROTA AL JEF√â!</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oxanium:wght@600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Oxanium', sans-serif;
      color: white;
      text-align: center;
      margin: 0;
      padding: 10px;
      background: #0a0a1a;
      position: relative;
      overflow-x: hidden;
      min-height: 100vh;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a1a 70%);
      z-index: -3;
    }
    .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
    .particle { position: absolute; border-radius: 50%; animation: float 15s infinite linear; }
    @keyframes float { to { transform: translate(var(--tx), var(--ty)) rotate(360deg); opacity: 0; } }

    .content { position: relative; z-index: 10; opacity: 0; animation: fadeIn 1.5s forwards; }
    @keyframes fadeIn { to { opacity: 1; } }

    /* Mesa de batalla */
    .battle-table {
      display: none;
      margin: 20px auto;
      max-width: 700px;
      background: rgba(5, 5, 15, 0.9);
      border: 3px solid gold;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 0 30px rgba(255,215,0,0.5);
      position: relative;
      overflow: hidden;
    }
    .battle-table::after {
      content: '';
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle, transparent 60%, rgba(0,0,0,0.7) 100%);
      pointer-events: none;
    }
    .battle-header {
      margin-bottom: 25px;
      font-size: 1.4em;
      color: #4ecdc4;
      text-shadow: 0 0 10px rgba(78,205,196,0.7);
    }

    /* Zonas de batalla */
    .battle-zone {
      display: flex;
      justify-content: space-between;
      margin: 30px 0;
    }
    .player-zone, .enemy-zone {
      width: 48%;
      text-align: center;
    }
    .zone-title {
      margin-bottom: 15px;
      font-weight: bold;
    }
    .player-zone .zone-title { color: #4ecdc4; }
    .enemy-zone .zone-title { color: #ff6b6b; }

    /* Carta en combate */
    .battle-card {
      position: relative;
      width: 160px;
      margin: 0 auto;
    }
    .card-image {
      width: 100%;
      border-radius: 12px;
      border: 3px solid #333;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }
    .card-rarity {
      position: absolute;
      top: 8px;
      right: 8px;
      font-size: 0.8em;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 10px;
      background: rgba(0,0,0,0.6);
    }
    .common { color: white; }
    .rare { color: #ff6b35; }
    .epic { color: #a29bfe; }
    .legendary { 
      color: transparent;
      background: linear-gradient(45deg, red, gold, blue, purple);
      -webkit-background-clip: text;
      background-clip: text;
      animation: rainbow 3s linear infinite;
    }

    /* Barra de vida */
    .hp-bar {
      width: 100%;
      height: 12px;
      background: #333;
      border-radius: 6px;
      margin-top: 8px;
      overflow: hidden;
    }
    .hp-fill {
      height: 100%;
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      width: 100%;
      transition: width 0.5s ease;
    }
    .hp-text {
      font-size: 0.9em;
      margin-top: 4px;
      color: #feca57;
    }

    /* Mazo de mano */
    .hand {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .hand-card {
      background: rgba(20,20,40,0.9);
      border-radius: 12px;
      padding: 10px;
      width: 120px;
      cursor: pointer;
      transition: transform 0.2s;
      border: 2px solid #45b7d1;
    }
    .hand-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 20px rgba(78,205,196,0.6);
    }
    .hand-card.fainted {
      opacity: 0.4;
      filter: grayscale(100%);
      cursor: not-allowed;
    }
    .hand-card img {
      width: 100%;
      border-radius: 8px;
    }

    /* Botones y log */
    .battle-log {
      background: rgba(0,0,0,0.6);
      padding: 15px;
      border-radius: 12px;
      margin: 20px 0;
      min-height: 80px;
      font-size: 1.15em;
      color: #feca57;
      border: 1px solid #4ecdc4;
    }
    .action-btn {
      background: #4ecdc4;
      color: #0a0a1a;
      border: none;
      padding: 12px 25px;
      font-size: 1.15em;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      margin: 10px 5px;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }
    .action-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 15px rgba(0,0,0,0.5);
    }

    /* Men√∫ principal */
    .main-menu {
      text-align: center;
    }
    .menu-btn {
      background: #ff6b6b;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 1.3em;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      margin: 20px 10px;
      transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(255,107,107,0.4);
    }
    .menu-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 20px rgba(255,107,107,0.6);
    }

    @keyframes rainbow { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

    @media (max-width: 600px) {
      .battle-card { width: 130px; }
      .hand-card { width: 100px; }
      .battle-table { padding: 15px; }
    }
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  <div class="content">
    <h1>FORTNITE SKIN BATTLE: ¬°DERROTA AL JEF√â!</h1>

    <!-- Men√∫ principal -->
    <div class="main-menu" id="mainMenu">
      <button class="menu-btn" onclick="startBattle()">‚öîÔ∏è ¬°INICIAR BATALLA!</button>
      <p style="color:#4ecdc4; margin-top:20px;">Arma tu mazo en "Colecci√≥n" antes de luchar.</p>
    </div>

    <!-- Mesa de batalla -->
    <div class="battle-table" id="battleTable">
      <div class="battle-header">MESA DE BATALLA - Ronda <span id="roundNumber">1</span></div>
      
      <div class="battle-zone">
        <div class="enemy-zone">
          <div class="zone-title">ENARIO</div>
          <div class="battle-card">
            <img id="enemyCardImg" class="card-image" src="" alt="Enemigo">
            <div class="card-rarity" id="enemyRarity"></div>
            <div class="hp-bar">
              <div class="hp-fill" id="enemyHpBar"></div>
            </div>
            <div class="hp-text">HP: <span id="enemyHp">0</span></div>
          </div>
        </div>
        
        <div class="player-zone">
          <div class="zone-title">T√ö</div>
          <div class="battle-card">
            <img id="playerCardImg" class="card-image" src="" alt="Jugador">
            <div class="card-rarity" id="playerRarity"></div>
            <div class="hp-bar">
              <div class="hp-fill" id="playerHpBar"></div>
            </div>
            <div class="hp-text">HP: <span id="playerHp">0</span></div>
          </div>
        </div>
      </div>

      <div class="battle-log" id="battleLog">
        ¬°Elige una carta de tu mazo para atacar!
      </div>

      <div class="hand" id="playerHand">
        <!-- Se llena con JS -->
      </div>

      <button class="action-btn" onclick="exitBattle()" style="background:#ff6b6b;">üö™ Salir</button>
    </div>
  </div>

  <audio id="hitSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" preload="auto"></audio>
  <audio id="loseSound" src="https://assets.mixkit.co/sfx/preview/mixkit-retro-arcade-lose-2027.mp3" preload="auto"></audio>
  <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>

  <script>
    // ==== CARTAS ====
    const CARDS = [
      { id:0, name:"Ram√≠rez", img:"https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", rarity:"common", atk:60, def:50, power:"Paso Firme", attackType:"wind", unlocked: true },
      { id:1, name:"Azulita", img:"https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", rarity:"rare", atk:70, def:55, power:"Confeti √Åcido", attackType:"fire", unlocked: true },
      { id:2, name:"Tormenta", img:"https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", rarity:"epic", atk:80, def:45, power:"Torbellino", attackType:"wind", unlocked: false },
      { id:3, name:"Fortaleza", img:"https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", rarity:"rare", atk:60, def:70, power:"Muralla", attackType:"ice", unlocked: true },
      { id:4, name:"Danza", img:"https://s93.erome.com/5472/K3IRZbxx/0VxSvgAl.jpeg?v=1764818017", rarity:"epic", atk:75, def:50, power:"Baile √âpico", attackType:"wind", unlocked: false },
      { id:5, name:"Furia", img:"https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", rarity:"legendary", atk:90, def:40, power:"Ira Incontenible", attackType:"fire", unlocked: false },
      { id:6, name:"Escudera", img:"https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", rarity:"common", atk:55, def:65, power:"Protecci√≥n", attackType:"ice", unlocked: true },
      { id:7, name:"Asesina", img:"https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", rarity:"legendary", atk:95, def:30, power:"Golpe Letal", attackType:"fire", unlocked: false },
      { id:8, name:"Guardiana", img:"https://s206.erome.com/4699/lpRzYjBO/P9p2wv5y.jpeg?v=1745795818", rarity:"epic", atk:50, def:80, power:"Escudo Energ√©tico", attackType:"ice", unlocked: false },
      { id:9, name:"JEFE FINAL", img:"https://s206.erome.com/4699/lpRzYjBO/gU2HfmRY.jpeg?v=1745795818", rarity:"legendary", atk:100, def:35, power:"Tirano", attackType:"arcane", unlocked: false }
    ];

    // ==== Estado del juego ====
    let currentDeck = JSON.parse(localStorage.getItem('currentDeck')) || [0, 3, 6];
    let playerCards = [];
    let enemyCard = null;
    let round = 1;
    let gameActive = true;
    let playerTurn = true;

    // ==== Funciones ====
    function createParticles() {
      const c = document.getElementById('particles');
      const n = 15;
      for (let i = 0; i < n; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        const s = Math.random() * 4 + 1;
        p.style.width = p.style.height = `${s}px`;
        p.style.left = `${Math.random() * 100}%`;
        p.style.top = `${Math.random() * 100}%`;
        const cols = ['rgba(255,107,107,0.7)','rgba(78,205,196,0.7)','rgba(254,202,87,0.7)'];
        p.style.background = cols[Math.floor(Math.random() * cols.length)];
        p.style.setProperty('--tx', `${(Math.random()-0.5)*200}px`);
        p.style.setProperty('--ty', `${(Math.random()-0.5)*200}px`);
        p.style.animationDuration = `${15 + Math.random() * 20}s`;
        c.appendChild(p);
      }
    }

    function startBattle() {
      // Cargar mazo
      const savedDeck = JSON.parse(localStorage.getItem('currentDeck')) || [0,3,6];
      currentDeck = savedDeck;
      
      playerCards = [];
      currentDeck.forEach(id => {
        const card = CARDS.find(c => c.id === id && c.unlocked);
        if (card) {
          playerCards.push({...card, currentHp: card.def, alive: true});
        }
      });

      if (playerCards.length === 0) {
        alert('¬°Tu mazo est√° vac√≠o! Ve a "Colecci√≥n" y arma tu mazo.');
        return;
      }

      // Enemigo: siempre el jefe final para prueba
      enemyCard = {...CARDS[9], currentHp: CARDS[9].def, alive: true};

      // Reiniciar estado
      round = 1;
      gameActive = true;
      playerTurn = true;

      // Mostrar mesa de batalla
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('battleTable').style.display = 'block';
      
      updateBattleUI();
    }

    function updateBattleUI() {
      document.getElementById('roundNumber').innerText = round;
      
      // Carta enemiga
      document.getElementById('enemyCardImg').src = enemyCard.img;
      document.getElementById('enemyRarity').innerText = enemyCard.rarity;
      document.getElementById('enemyRarity').className = `card-rarity ${enemyCard.rarity}`;
      document.getElementById('enemyHp').innerText = enemyCard.currentHp;
      document.getElementById('enemyHpBar').style.width = `${(enemyCard.currentHp / enemyCard.def) * 100}%`;
      
      // Carta del jugador (la primera viva)
      const activePlayerCard = playerCards.find(c => c.alive);
      if (activePlayerCard) {
        document.getElementById('playerCardImg').src = activePlayerCard.img;
        document.getElementById('playerRarity').innerText = activePlayerCard.rarity;
        document.getElementById('playerRarity').className = `card-rarity ${activePlayerCard.rarity}`;
        document.getElementById('playerHp').innerText = activePlayerCard.currentHp;
        document.getElementById('playerHpBar').style.width = `${(activePlayerCard.currentHp / activePlayerCard.def) * 100}%`;
      }

      // Mazo de mano
      const handEl = document.getElementById('playerHand');
      handEl.innerHTML = '';
      playerCards.forEach(card => {
        if (card.alive) {
          const cardEl = document.createElement('div');
          cardEl.className = 'hand-card';
          cardEl.innerHTML = `
            <img src="${card.img}" alt="${card.name}">
            <div style="font-size:0.9em; margin-top:5px;">${card.name}</div>
            <div style="color:#feca57; font-size:0.85em;">ATK: ${card.atk}</div>
          `;
          cardEl.onclick = () => selectPlayerCard(card.id);
          handEl.appendChild(cardEl);
        } else {
          const cardEl = document.createElement('div');
          cardEl.className = 'hand-card fainted';
          cardEl.innerHTML = `
            <img src="${card.img}" alt="${card.name}" style="filter:grayscale(100%);">
            <div style="font-size:0.9em; margin-top:5px; color:#ff6b6b;">Eliminada</div>
          `;
          handEl.appendChild(cardEl);
        }
      });
    }

    function selectPlayerCard(cardId) {
      if (!gameActive || !playerTurn) return;
      
      const playerCard = playerCards.find(c => c.id === cardId && c.alive);
      if (!playerCard) return;
      
      const log = document.getElementById('battleLog');
      log.innerHTML = `¬°${playerCard.name} ataca con <strong>${playerCard.power}</strong>!`;

      // Calcular da√±o
      const damage = Math.max(5, playerCard.atk - Math.floor(enemyCard.def * 0.3)); // Da√±o parcial para mostrar HP

      // Aplicar da√±o al enemigo
      setTimeout(() => {
        enemyCard.currentHp = Math.max(0, enemyCard.currentHp - damage);
        updateBattleUI();
        document.getElementById('hitSound').play().catch(()=>{});

        if (enemyCard.currentHp <= 0) {
          log.innerHTML = `¬°${playerCard.name} derrot√≥ a ${enemyCard.name}!`;
          setTimeout(() => {
            round++;
            if (round > 3) {
              endBattle(true);
            } else {
              // Nuevo enemigo
              enemyCard = {...CARDS[round + 5], currentHp: CARDS[round + 5].def, alive: true};
              playerTurn = true;
              updateBattleUI();
              log.innerHTML = `¬°Ronda ${round}! Elige tu carta para atacar:`;
            }
          }, 1500);
        } else {
          log.innerHTML += `<br>¬°Turno de la IA!`;
          setTimeout(() => iaAttack(playerCard), 1500);
        }
        playerTurn = false;
      }, 800);
    }

    function iaAttack(playerCard) {
      if (!gameActive) return;
      
      const log = document.getElementById('battleLog');
      const damage = Math.max(5, enemyCard.atk - Math.floor(playerCard.def * 0.3));

      log.innerHTML = `¬°${enemyCard.name} ataca a ${playerCard.name}!`;

      setTimeout(() => {
        playerCard.currentHp = Math.max(0, playerCard.currentHp - damage);
        updateBattleUI();
        document.getElementById('hitSound').play().catch(()=>{});

        if (playerCard.currentHp <= 0) {
          playerCard.alive = false;
          log.innerHTML = `¬°${playerCard.name} fue eliminada!`;
          
          // Verificar si hay m√°s cartas
          const aliveCards = playerCards.filter(c => c.alive);
          if (aliveCards.length === 0) {
            endBattle(false);
            return;
          }
        }

        playerTurn = true;
        log.innerHTML = `¬°Tu turno! Elige una carta para atacar:`;
      }, 800);
    }

    function endBattle(isWin) {
      gameActive = false;
      const log = document.getElementById('battleLog');
      log.innerHTML = `
        <h3 style="color:${isWin ? 'gold' : '#ff6b6b'};">
          ${isWin ? 'üéâ ¬°VICTORIA ROYALE!' : 'üíÄ DERROTA'}
        </h3>
        <p style="margin-top:15px;">${isWin ? '¬°Has derrotado al Jefe Final!' : 'Todas tus cartas fueron eliminadas.'}</p>
      `;
      document.getElementById(isWin ? 'winSound' : 'loseSound').play();
    }

    function exitBattle() {
      document.getElementById('battleTable').style.display = 'none';
      document.getElementById('mainMenu').style.display = 'block';
    }

    // Iniciar
    createParticles();
  </script>
</body>
</html>
